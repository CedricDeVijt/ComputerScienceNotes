![[Screenshot 2024-05-28 at 17.23.59.png]]

## 5.4.1 Link-Layer Addresses
### Network Interfaces
- *Adapters*: Hosts and routers have link-layer addresses associated with their network interfaces (adapters), not the devices themselves.
- *Multiple interfaces*: A host or router with multiple network interfaces will have multiple link-layer addresses, just as it would have multiple IP addresses.
### Link-Layer Switches
- *No addresses*: Link-layer switches do not have link-layer addresses for their interfaces that connect to hosts and routers.
- *Transparent operation*: Switches carry datagrams between hosts and routers without requiring explicit addressing to the switch.
### MAC Addresses
- *Terminology*: Link-layer addresses are commonly known as MAC addresses.
- *Length*: MAC addresses are typically 6 bytes long, allowing for 2^48 possible addresses.
- *Permanence*: Originally designed to be permanent, but can now be changed via software.
### Uniqueness of MAC Addresses
#### Global Management
- *No duplicates*: Each adapter has a unique MAC address, despite the global manufacturing of adapters.
- *IEEE management*: The IEEE manages the MAC address space to ensure uniqueness.
#### Address Allocation
- *Chunk allocation*: Companies purchase chunks of 2^24 addresses from IEEE.
- *Fixed bits*: The first 24 bits of the MAC address are fixed by IEEE.
- *Variable bits*: Companies create unique combinations of the last 24 bits for each adapter within their allocated chunk.

## 5.4.2 Address Resolution Protocol (ARP)
### Purpose
- *Translation*: ARP translates between network-layer addresses (IP addresses) and link-layer addresses (MAC addresses).

![[Screenshot 2024-05-28 at 17.25.22.png]]
### Example Scenario
- *Hosts and Routers*: Each host and router has a single IP address and single MAC address.
- *Sending IP datagram*: Host 222.222.222.220 wants to send an IP datagram to host 222.222.222.222.
- *Determining MAC address*: The sending host uses ARP to determine the MAC address for the destination IP address.
### ARP Module
- *Function*: Takes an IP address on the same LAN as input and returns the corresponding MAC address.
- *Example operation*: 
  - Input: IP address 222.222.222.222
  - Output: MAC address 49-BD-D2-C7-56-2A
### ARP Table
#### Structure
- *Mappings*: Contains mappings of IP addresses to MAC addresses.
- *Time-to-Live (TTL)*: Each entry has a TTL value indicating when the mapping will be deleted from the table.
#### Example ARP Table Entry
- *IP address*: 222.222.222.222
- *MAC address*: 49-BD-D2-C7-56-2A
- *TTL value*: Indicates when the entry will expire (typically 20 minutes from placement).
#### Notes
- *Partial entries*: The table may not contain an entry for every host and router on the subnet.
- *Expiration*: Entries can expire, necessitating ARP requests to refresh mappings.

## 5.4.3 Relevance of Ethernet MAC Protocol in Switch-Based LANs

### Evolution of Ethernet Topologies
- *From bus and hub-based topologies*: Where Ethernet was a broadcast link with frame collisions.
- *To switch-based star topologies*: Utilizing store-and-forward packet switching.
### Need for MAC Protocol in Switch-Based LANs
#### Switch Functionality
- *Frame coordination*: Modern switches coordinate transmissions and never forward more than one frame onto the same interface simultaneously.
- *Full-duplex operation*: Switches and nodes can send frames to each other simultaneously without interference.
#### Conclusion
- *Absence of collisions*: In switch-based Ethernet LANs, collisions are eliminated due to switch functionality.
- *No need for MAC protocol*: Collisions are inherent in broadcast links, but in switch-based LANs, where collisions are eliminated, there's no need for a MAC protocol.

## 5.4.4 Ethernet Frame Structure
### Data Field (46 to 1,500 bytes)
- *Carries IP datagram*: Contains the IP datagram for transmission.
- *MTU limit*: Maximum Transmission Unit (MTU) of Ethernet is 1,500 bytes.
- *Fragmentation*: If IP datagram exceeds 1,500 bytes, fragmentation is required.
- *Stuffing*: If IP datagram is less than 46 bytes, the data field is "stuffed" to fill it out to 46 bytes.
### Destination Address (6 bytes)
- *MAC address*: Contains the MAC address of the destination adapter.
- *Frame processing*: 
  - If destination address matches adapter's own address or MAC broadcast address, the frame's data field is passed to the network layer.
  - If the destination address is different, the frame is discarded.
### Source Address (6 bytes)
- *MAC address*: Contains the MAC address of the transmitting adapter.
### Type Field (2 bytes)
- *Multiplexing network-layer protocols*: Allows Ethernet to support multiple network-layer protocols.
- *Protocol identification*: Identifies the network-layer protocol used (e.g., IP, Novell IPX, AppleTalk).
- *ARP protocol*: Has its own type number (0806 hexadecimal) for demultiplexing ARP packets.
### Cyclic Redundancy Check (CRC) (4 bytes)
- *Error detection*: Allows the receiving adapter to detect bit errors in the frame.
### Preamble (8 bytes)
- *Field structure*: 
  - 7 bytes with value 10101010.
  - Last byte with value 10101011.
- *Purpose*:
  - *Wake-up*: Aids in waking up receiving adapters.
  - *Clock synchronization*: Synchronizes receiving adapters' clocks with the sender's clock.

![[Screenshot 2024-05-28 at 17.29.42.png]]

## 5.4.5 Switch Functionality
### Role
- *Frame forwarding*: Receives incoming link-layer frames and forwards them onto outgoing links.
- *Transparency*: Transparent to hosts and routers in the subnet.
### Interface Capacity
- *Buffering*: Switch output interfaces have buffers to accommodate rates exceeding interface capacity, similar to router output interfaces.
### Switch Operations
#### Filtering
- *Function*: Determines whether a frame should be forwarded or dropped.
- *Switch Table*: Used for filtering and forwarding decisions.
#### Forwarding
- *Function*: Determines interfaces to which a frame should be directed and moves the frame to those interfaces.
#### Switch Table
- *Entries*: Contains MAC addresses and associated interface information.
- *Entry components*:
  1. MAC address
  2. Switch interface leading toward that MAC address
  3. Time of entry placement
### Filtering and Forwarding Logic
#### Case Scenarios
1. *No entry for destination address*:
   - *Action*: Switch broadcasts the frame to all interfaces except the incoming interface.
2. *Entry associates destination address with incoming interface*:
   - *Action*: Switch discards the frame, as it is coming from the same LAN segment.
3. *Entry associates destination address with a different interface*:
   - *Action*: Switch forwards the frame to the associated interface's LAN segment by placing it in the output buffer preceding that interface.

## 5.4.6 Self-Learning Switch Operation
### Automatic Table Building
#### Initial State
1. *Empty table*: The switch table is initially empty.
#### Learning Process
2. *Frame reception*: 
   - For each incoming frame received on an interface:
     1. *Record information*: The switch stores in its table:
        - The MAC address in the frameâ€™s source address field.
        - The interface from which the frame arrived.
        - The current time.
     2. *LAN segment identification*: Records the LAN segment on which the sender resides.
### Table Maintenance
#### Address Deletion
3. *Aging process*:
   - The switch deletes an address in the table if:
     - No frames are received with that address as the source address after a certain period of time (the aging time).
   - Ensures outdated entries are removed.
   - Facilitates adaptation to network changes (e.g., device replacement).
### Benefits
- *Autonomy*: Switches dynamically and autonomously manage their tables without network administrator intervention.
- *Efficiency*: Simplifies network administration by eliminating manual configuration processes.
- *Adaptability*: Automatically adjusts to changes in the network topology and device configurations.

## Pros and Cons of Switches

### Pros

#### Plug-and-Play
- *Ease of setup*: Switches are plug-and-play devices, requiring minimal configuration.
- *Administrative convenience*: Simplifies deployment for network administrators.

#### High Filtering and Forwarding Rates
- *Efficiency*: Processes frames only up to layer 2, resulting in high filtering and forwarding rates.

### Cons

#### Spanning Tree Limitation
- *Topology restriction*: Active topology of a switched network is limited to a spanning tree to prevent broadcast frame cycling.

#### ARP Table Management
- *Resource demand*: Large switched networks require large ARP tables in hosts and routers, leading to substantial ARP traffic and processing overhead.

#### Broadcast Storm Vulnerability
- *Network instability*: Susceptibility to broadcast storms where endless streams of Ethernet broadcast frames overwhelm switches, causing network collapse.

## 5.4.7 Pros and Cons of Routers
### Pros
#### Hierarchical Network Addressing
- *Efficient routing*: Hierarchical network addressing prevents packet cycling through routers, enabling optimal path selection between source and destination.
#### Rich Topology
- *Enhanced connectivity*: Routers allow building a rich topology with multiple active links, facilitating robust network designs like those in the Internet.
#### Firewall Protection
- *Security feature*: Provides firewall protection against layer-2 broadcast storms, ensuring network stability.
### Cons
#### Configuration Complexity
- *Setup complexity*: Routers and connected hosts require IP address configuration, making them less plug-and-play compared to switches.
#### Processing Overhead
- *Increased processing time*: Routers often have larger per-packet processing times as they handle up through layer 3 fields, leading to slower forwarding compared to switches.

## 5.4.8 Drawbacks of Hierarchical LAN Configurations
### Lack of Traffic Isolation
- *Broadcast traffic*: Broadcast messages traverse the entire institutional network, impacting LAN performance and potentially compromising security/privacy.
- *Desired isolation*: There's a need to limit broadcast traffic scope for security reasons, especially to prevent sensitive information from reaching unauthorized hosts.
### Inefficient Use of Switches
- *Scalability issues*: As the number of groups increases, more first-level switches are required, leading to inefficient use of resources.
- *Traffic isolation*: Large switches may accommodate all users but fail to provide necessary traffic isolation.
### Managing Users
- *Physical cabling complexity*: Employee movements between groups require changes in physical cabling, complicating network management.
- *Dual group membership*: Employees belonging to multiple groups exacerbate the management challenge.
## 5.4.9 VLANs as a Solution
### Definition
- **Virtual LANs (VLANs)**: Allow multiple virtual LANs over a single physical network infrastructure, enabling hosts within a VLAN to communicate as if they were on separate switches.
### Implementation
- *Port-based VLANs*: Switch ports are grouped into VLANs by the network manager, forming broadcast domains.
### Addressing Isolation Challenges
- *Inter-VLAN communication*: VLANs are logically isolated, but inter-departmental traffic can be facilitated through router connections.
- *Router integration*: Router connections between VLANs mimic separate switches, enabling communication while maintaining logical isolation.
- *Integrated devices*: Some switches combine VLAN functionality with routing capabilities, simplifying network management.

![[Screenshot 2024-05-28 at 17.36.17.png]]

## 5.4.10 Interconnecting VLAN Switches: VLAN Trunking
### Problem Statement
- **Multiple Buildings**: Departments spread across different buildings require network access within the same VLAN.
- **Interconnection Challenge**: How to efficiently connect switches across buildings without excessive port usage.
### Conventional Approach: Individual VLAN Ports
- **Port-By-Port Connection**: Each VLAN requires a dedicated port on both switches for interconnection.
- **Scalability Issue**: As VLAN count increases, port usage grows linearly, leading to inefficiency.
### Scalable Solution: VLAN Trunking
- **Trunk Port**: Designate a special port on each switch as a trunk port for interconnecting VLAN switches.
- **Flexible Connectivity**: Trunk port connects all VLANs, facilitating communication between switches.
- **Efficient Port Utilization**: Only a single port per switch is required for interconnecting multiple VLANs.
### Implementing VLAN Trunking with 802.1Q
- **Extended Ethernet Frame**: Utilize the 802.1Q frame format for VLAN-tagged frames crossing VLAN trunks.
- **VLAN Tag Structure**:
  - *Tag Protocol Identifier (TPID)*: Identifies the frame as VLAN-tagged (fixed hexadecimal value of 81-00).
  - *Tag Control Information*: Contains a 12-bit VLAN identifier field.
  - *Priority Field*: Similar to the IP datagram TOS field, it specifies frame priority.
### Benefits of VLAN Trunking
- **Scalability**: Efficiently connects multiple VLANs across switches without excessive port usage.
- **Flexibility**: Facilitates inter-VLAN communication while maintaining VLAN isolation.
- **Efficiency**: Optimizes network resource utilization by minimizing port requirements.