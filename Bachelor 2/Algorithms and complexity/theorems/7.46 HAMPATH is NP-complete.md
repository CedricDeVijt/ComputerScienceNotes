## PROOF IDEA

To show that every NP-problem is polynomial time reducible to HAMPATH, we show that 3SAT is polynomial time reducible to HAMPATH. We give a way to convert 3CNF-formulas to graphs in which Hamiltonian paths correspond to satisfying assignments of the formula. The graphs contain gadgets that mimic variables and clauses. The variable gadget is a diamond structure that can be traversed in either of two ways, corresponding to the two truth settings. The clause gadget is a node. Ensuring that the path goes through each clause gadget corresponds to ensuring that each clause is satisfied in the satisfying assignment.

## PROOF

We previously demonstrated that HAMPATH is in NP, so all that remains to be done is to show $3SAT ≤_P HAMPATH$. For each 3CNF-formula $\phi$, we show how to construct a directed graph G with two nodes, s and t, where a Hamiltonian path exists between s and t iff $\phi$ is satisfiable. We start the construction with a 3CNF-formula $\phi$ containing k clauses,

$$ \phi = (a_1 \lor b_1 \lor c_1) \land (a_2 \lor b_2 \lor c_2) \land \dots \land (a_k \lor b_k \lor c_k) $$

where each a, b, and cis a literal $x_i$ or $\overline{x_i}$. Let $x_1, \dots ,x_l$ be the l variables of $\phi$. Now we show how to convert $\phi$ to a graph G. The graph G that we construct has various parts to represent the variables and clauses that appear in $\phi$. We represent each variable $x_i$ with a diamond-shaped structure that contains a horizontal row of nodes, as shown in the following figure. Later we specify the number of nodes that appear in the horizontal row.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171240.png]]

We represent each clause of $\phi$ as a single node, as follows.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171325.png]]

The following figure depicts the global structure of G. It shows all the elements of G and their relationships, except the edges that represent the relationship of the variables to the clauses that contain them.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171408.png]]

Next, we show how to connect the diamonds representing the variables to the nodes representing the clauses. Each diamond structure contains a horizontal row of nodes connected by edges running in both directions. The horizontal row contains $3k + 1$ nodes in addition to the two nodes on the ends belonging to the diamond. These nodes are grouped into adjacent pairs, one for each clause, with extra separator nodes next to the pairs, as shown in the following figure.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171454.png]]

If variable $x_i$ appears in clause $c_j$ , we add the following two edges from the jth pair in the ith diamond to the jth clause node.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171535.png]]

If $\overline{x_i}$ appears in clause $c_j$ , we add two edges from the jth pair in the ith diamond to the jth clause node. After we add all the edges corresponding to each occurrence of $x_i$ or $\overline{x_i}$ in each clause, the construction of G is complete. To show that this construction works, we argue that if $\phi$ is satisfiable, a Hamiltonian path exists from s to t; and, conversely, if such a path exists, $\phi$ is satisfiable.

Suppose that $\phi$ is satisfiable. To demonstrate a Hamiltonian path from s to t, we first ignore the clause nodes. The path begins at s, goes through each diamond in turn, and ends up at t. To hit the horizontal nodes in a diamond, the path either zig-zags from left to right or zag-zigs from right to left; the satisfying assignment to $\phi$ determines which. If xi is assigned TRUE, the path zig-zags through the corresponding diamond. If xi is assigned FALSE, the path zag-zigs. We show both possibilities in the following figure.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171759.png]]

So far, this path covers all the nodes in G except the clause nodes. We can easily include them by adding detours at the horizontal nodes. In each clause, we select one of the literals assigned TRUE by the satisfying assignment.

If we selected ${x_i}$ in clause $c_j$, we can detour at the jth pair in the ith diamond. Doing so is possible because $x_i$ must be TRUE, so the path zig-zags from left to right through the corresponding diamond. Hence the edges to the cj node are in the correct order to allow a detour and return.

Similarly, if we selected $\overline{x_i}$ in clause cj , we can detour at the jth pair in the ith diamond because $x_i$ must be FALSE, so the path zag-zigs from right to left through the corresponding diamond. Hence the edges to the cj node again are in the correct order to allow a detour and return. (Note that each true literal in a clause provides an option of a detour to hit the clause node. As a result, if several literals in a clause are true, only one detour is taken.) Thus, we have constructed the desired Hamiltonian path.

For the reverse direction, if G has a Hamiltonian path from s to t, we demonstrate a satisfying assignment for $\phi$. If the Hamiltonian path is normal — that is, it goes through the diamonds in order from the top one to the bottom one, except for the detours to the clause nodes—we can easily obtain the satisfying assignment. If the path zig-zags through the diamond, we assign the corresponding variable TRUE; and if it zag-zigs, we assign FALSE. Because each clause node appears on the path, by observing how the detour to it is taken, we may determine which of the literals in the corresponding clause is TRUE.

All that remains to be shown is that a Hamiltonian path must be normal. Normality may fail only if the path enters a clause from one diamond but returns to another, as in the following figure.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531171858.png]]

The path goes from node $a_1$ to c; but instead of returning to $a_2$ in the same diamond, it returns to $b_2$ in a different diamond. If that occurs, either $a_2$ or $a_3$ must be a separator node. If $a_2$ were a separator node, the only edges entering $a_2$ would be from $a_1$ and $a_3$. If $a_3$ were a separator node, $a_1$ and $a_2$ would be in the same clause pair, and hence the only edges entering $a_2$ would be from $a_1$, $a_3$, and c. In either case, the path could not contain node $a_2$. The path cannot enter $a_2$ from cor $a_1$ because the path goes elsewhere from these nodes. The path cannot enter $a_2$ from $a_3$ because $a_3$ is the only available node that $a_2$ points at, so the path must exit $a_2$ via $a_3$. Hence a Hamiltonian path must be normal. This reduction obviously operates in polynomial time and the proof is complete.

$\blacksquare$
