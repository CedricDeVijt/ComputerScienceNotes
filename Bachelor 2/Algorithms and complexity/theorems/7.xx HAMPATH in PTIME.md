To show that HAMPATH = {<G, s, t> | there is a path from s to t in the directed graph G that visits each vertex only once} is in NP, we need to demonstrate that there exists a polynomial-time verifier that can check whether a given solution (certificate) for an instance of HAMPATH is valid. A problem is in NP if, given a certificate, we can verify in polynomial time whether it is a solution to the problem.

### Step 1: Define the Certificate

For HAMPATH, a natural certificate is a sequence of vertices representing a potential Hamiltonian path from s to t in the directed graph G. Let the certificate be a sequence of vertices $p = (v_1, v_2, \ldots, v_k)$, where $v_1 = s$, $v_k = t$, and each vertex in the sequence is claimed to form a path that visits each vertex in G exactly once (except possibly for vertices not included in the path, if the graph has more vertices than the path length).

### Step 2: Construct the Polynomial-Time Verifier

We need a verifier algorithm $V(G, s, t, p)$ that takes as input:

- $G$: a directed graph, represented as an adjacency list or matrix.
- $s$: the start vertex.
- $t$: the end vertex.
- $p$: the certificate, a sequence of vertices $(v_1, v_2, \ldots, v_k)$.

The verifier must check in polynomial time whether $p$ is a valid Hamiltonian path from s to t, i.e., a path that visits each vertex in the sequence exactly once and respects the edges of G.

The verifier performs the following steps:

1. **Check the start and end vertices**: Verify that $v_1 = s$ and $v_k = t$.
2. **Check vertex uniqueness**: Ensure that all vertices in $p = (v_1, v_2, \ldots, v_k)$ are distinct, i.e., no vertex appears more than once in the sequence.
3. **Check edge validity**: For each pair of consecutive vertices $(v_i, v_{i+1})$ in $p$, verify that there is a directed edge $(v_i, v_{i+1}) \in E$ in the graph G.
4. **Check path length**: Ensure that the number of vertices in $p$ is at most $n$ (the number of vertices in G), since a Hamiltonian path cannot visit more vertices than are in the graph. (Note: For a path from s to t to be a valid Hamiltonian path in the standard sense, it often implies visiting all vertices, but the problem definition allows a path visiting each vertex at most once, so we check that the path is valid without requiring it to cover all vertices unless specified.)

### Step 3: Verify Polynomial Time

Letâ€™s analyze the time complexity of the verifier:

- **Input size**: Suppose the graph G has $n$ vertices and $m$ edges. The certificate $p$ is a sequence of at most $n$ vertices. The graph can be represented as an adjacency matrix (size $O(n^2)$) or adjacency list (size $O(n + m)$).
- **Step 1: Check start and end vertices**: Compare $v_1$ with $s$ and $v_k$ with $t$. This takes $O(1)$ time per comparison, so $O(1)$ total.
- **Step 2: Check vertex uniqueness**: Iterate through the sequence $p$, which has at most $n$ vertices, and use a hash set to check for duplicates. Inserting and checking each vertex takes $O(1)$ amortized time, so this step takes $O(n)$ time.
- **Step 3: Check edge validity**: For each of the $k-1 \leq n-1$ pairs $(v_i, v_{i+1})$, check if the edge $(v_i, v_{i+1})$ exists in G.
  - If G is represented as an adjacency matrix, checking an edge takes $O(1)$, so this step takes $O(n)$ time for up to $n-1$ edges.
  - If G is represented as an adjacency list, checking if $(v_i, v_{i+1})$ exists requires scanning the adjacency list of $v_i$, which takes $O(n)$ in the worst case (if $v_i$ has edges to all other vertices). For $n-1$ pairs, this takes $O(n^2)$.
- **Step 4: Check path length**: Verify that the length of $p$ (number of vertices) is at most $n$. This is a simple count, taking $O(n)$ time to read the sequence.

The total time is:

- Adjacency matrix: $O(n)$ (for steps 1, 2, and 4) + $O(n)$ (for step 3) = $O(n)$.
- Adjacency list: $O(n)$ (for steps 1, 2, and 4) + $O(n^2)$ (for step 3) = $O(n^2)$.

In either case, the verifier runs in polynomial time ($O(n^2)$ or better).

### Step 4: Correctness of the Verifier

- **If $<G, s, t> \in \text{HAMPATH}$**: There exists a Hamiltonian path from s to t, say $(v_1 = s, v_2, \ldots, v_k = t)$, where all vertices are distinct and each $(v_i, v_{i+1}) \in E$. The verifier will accept this path because:
  - $v_1 = s$ and $v_k = t$.
  - All vertices in the path are distinct.
  - All consecutive pairs correspond to edges in G.
  - The path length is at most $n$.
- **If $<G, s, t> \notin \text{HAMPATH}$**: For any certificate $p$, at least one check will fail (wrong start/end vertices, repeated vertices, invalid edges, or an invalid path structure), so the verifier rejects.

### Step 5: Conclusion

Since we have a polynomial-time verifier that correctly accepts valid Hamiltonian paths and rejects invalid ones, HAMPATH is in NP. The verifier checks a proposed solution (certificate) in $O(n^2)$ time (using an adjacency list) or $O(n)$ time (using an adjacency matrix), satisfying the requirement for NP.

Thus, HAMPATH is in NP.
