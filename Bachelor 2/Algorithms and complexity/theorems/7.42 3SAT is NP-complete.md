## PROOF

Obviously 3SAT is in NP, so we only need to prove that all languages in NP reduce to 3SAT in polynomial time. One way to do so is by showing that SAT polynomial time reduces to 3SAT. Instead, we modify the proof of Cook-Levin theorem so that it directly produces a formula in conjunctive normal form
with three literals per clause.

Cook-Levin theorem produces a formula that is already almost in conjunctive normal form. Formula $\phi_{cell}$ is a big AND of subformulas, each of which contains a big OR and a big AND of ORs. Thus, $\phi_{cell}$ is an AND of clauses and so is already in cnf. Formula $\phi_{start}$ is a big AND of variables. Taking each of these variables to be a clause of size 1, we see that $\phi_{start}$ is in cnf. Formula $\phi_{accept}$ is a big OR of variables and is thus a single clause. Formula $\phi_{move}$ is the only one that isnâ€™t already in cnf, but we may easily convert it into a formula that is in cnf as follows. Recall that $\phi_{move}$ is a big AND of subformulas, each of which is an OR of ANDs that describes all possible legal windows. The distributive laws, as described in Chapter 0, state that we can replace an OR of ANDs with an equivalent AND of ORs. Doing so may significantly increase the size of each subformula, but it can only increase the total size of $\phi_{move}$ by a constant factor because the size of each subformula depends only on N. The result is a formula that is in conjunctive normal form.

Now that we have written the formula in cnf, we convert it to one with three literals per clause. In each clause that currently has one or two literals, we replicate one of the literals until the total number is three. In each clause that has more than three literals, we split it into several clauses and add additional variables to preserve the satisfiability or nonsatisfiability of the original.

$\blacksquare$