## PROOF IDEA

We have already shown that SUBSET-SUM is in NP in Theorem 7.25. We prove that all languages in NP are polynomial time reducible to SUBSET-SUM by reducing the NP-complete language 3SAT to it. Given a 3CNF-formula $\phi$, we construct an instance of the SUBSET-SUM problem that contains a subcollection summing to the target t if and only if $\phi$ is satisfiable. Call this subcollection T.

To achieve this reduction, we find structures of the SUBSET-SUM problem that represent variables and clauses. The SUBSET-SUM problem instance that we construct contains numbers of large magnitude presented in decimal notation. We represent variables by pairs of numbers and clauses by certain positions in the decimal representations of the numbers.

We represent variable $x_i$ by two numbers, $y_i$ and $z_i$. We prove that either $y_i$ or $z_i$ must be in T for each i, which establishes the encoding for the truth value of $x_i$ in the satisfying assignment. Each clause position contains a certain value in the target t, which imposes a requirement on the subset T. We prove that this requirement is the same as the one in the corresponding clause — namely, that one of the literals in that clause is assigned TRUE.

## PROOF

We already know that $SUBSET-SUM \in NP$, so we now show that $3SAT ≤_P SUBSET-SUM$.

Let $\phi$ be a Boolean formula with variables $x_1, \dots ,x_l$ and clauses $c_1, \dots ,c_k$. The reduction converts $\phi$ to an instance of the SUBSET-SUM problem $⟨S,t⟩$, wherein the elements of S and the number t are the rows in the table, expressed in ordinary decimal notation. The rows above the double line are labeled and constitute the elements of S. The row below the double line is t.

$y_1, z_1, y_2, z_2, \dots ,y_l, z_l$ and $g_1, h1, g_2, h_2, \dots ,g_k, h_k$.

Thus, S contains one pair of numbers, $y_i$, $z_i$, for each variable $x_i$ in $\phi$. The decimal representation of these numbers is in two parts, as indicated in the table. The left-hand part comprises a 1 followed by $l−i$ 0s. The right-hand part contains one digit for each clause, where the digit of $y_i$ in column $c_j$ is 1 if clause $c_j$ contains literal $x_i$, and the digit of $z_i$ in column $c_j$ is 1 if clause $c_j$ contains literal $x_i$. Digits not specified to be 1 are 0.

The table is partially filled in to illustrate sample clauses, $c_1$, $c_2$, and $c_k$:

$$ (x_1 \lor \overline{x_2} \lor x_3) \land (x_1 \lor x_3 \lor \dots) \land \dots \land (\overline{x_3} \lor \dots \lor \dots) $$

Additionally, S contains one pair of numbers, $g_j$ ,$h_j$ , for each clause $c_j$ . These two numbers are equal and consist of a 1 followed by $k−j$ 0s.

Finally, the target number t, the bottom row of the table, consists of l 1s followed by k 3s.

![[Bachelor 2/Algorithms and complexity/images/Pasted image 20250531175549.png]]

Next, we show why this construction works. We demonstrate that $\phi$ is satisfiable iff some subset of S sums to t.

Suppose that \phi$ is satisfiable. We construct a subset of S as follows. We select $y_i$ if $x_i$ is assigned TRUE in the satisfying assignment, and $z_i$ if $x_i$ is assigned FALSE. If we add up what we have selected so far, we obtain a 1 in each of the first l digits because we have selected either $y_i$ or $z_i$ for each i. Furthermore, each of the last k digits is a number between 1 and 3 because each clause is satisfied and so contains between 1 and 3 true literals. We additionally select enough of the g and hnumbers to bring each of the last k digits up to 3, thus hitting the target.

Suppose that a subset of S sums to t. We construct a satisfying assignment to $\phi$ after making several observations. First, all the digits in members of S are either 0 or 1. Furthermore, each column in the table describing S contains at most five 1s. Hence a “carry” into the next column never occurs when a subset of S is added. To get a 1 in each of the first l columns, the subset must have either $y_i$ or $z_i$ for each i, but not both.

Now we make the satisfying assignment. If the subset contains $y_i$, we assign $x_i$ TRUE; otherwise, we assign it FALSE. This assignment must satisfy $\phi$ because in each of the final kcolumns, the sum is always 3. In column $c_j$ , at most 2 can
come from $g_j$ and $h_j$ , so at least 1 in this column must come from some $y_i$ or zi in the subset. If it is $y_i$, then $x_i$ appears in $c_j$ and is assigned TRUE, so $c_j$ is satisfied. If it is zi, then $x_i$ appears in $c_j$ and $x_i$ is assigned FALSE, so $c_j$ is satisfied. Therefore, $\phi$ is satisfied.

Finally, we must be sure that the reduction can be carried out in polynomial time. The table has a size of roughly $(k + l)^2$ and each entry can be easily calculated for any $\phi$ . So the total time is $O(n^2)$ easy stages.
